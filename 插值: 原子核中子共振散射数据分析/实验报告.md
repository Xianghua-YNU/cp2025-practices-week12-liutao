# 中子共振散射实验数据分析 - 实验报告

## 1. 实验目的

本实验旨在通过分析中子共振散射实验数据，掌握两种插值方法(拉格朗日多项式和三次样条)的实现和应用。具体目标包括：

- 理解并实现拉格朗日多项式插值算法
- 理解并实现三次样条插值算法
- 学习使用插值方法分析实验数据中的共振峰特性
- 比较不同插值方法的结果和适用性

## 2. 方法简述

请简要描述你实现各个任务的方法和思路，特别是：

- 拉格朗日多项式插值的实现方式
-  **实现方式**：基于拉格朗日插值公式，构造基函数的线性组合：
  $$
  P(x) = \sum_{i=0}^{n} y_i \prod_{\substack{j=0 \\ j \neq i}}^{n} \frac{x - x_j}{x_i - x_j}
  $$
  通过双重循环计算每个插值点的基函数加权和，处理分母为零的情况以避免数值错误。

- 三次样条插值的实现方式
- **实现方式**：利用`scipy.interpolate.interp1d`的`kind='cubic'`选项，默认采用自然样条边界条件（二阶导数为零），确保分段三次多项式在节点处函数值、一阶导数和二阶导数连续。

- 共振峰位置和半高全宽(FWHM)的计算方法
- **峰值位置**：使用`np.argmax`找到插值曲线最大值对应的能量值。  
- **FWHM**：计算半高位置，通过线性插值确定左、右半高点，差值即为半高全宽。
- 可视化实现的关键步骤
- 1. 生成密集插值点（`np.linspace(0, 200, 5000)`）；  
2. 调用插值函数生成曲线；  
3. 绘制原始数据点（带误差棒）、两种插值曲线，标注峰值位置。

## 3. 实验结果

### 3.1 插值结果对比

请在此处描述两种插值方法的实现结果：

1. 拉格朗日多项式插值结果：
   - 插值曲线特征：
   - 计算得到的共振峰位置：____74.5__ MeV
   - 计算得到的FWHM：___58.1___ MeV

2. 三次样条插值结果：
   - 插值曲线特征：
   - 计算得到的共振峰位置：__76.2____ MeV
   - 计算得到的FWHM：___58.5___ MeV

### 3.2 插值曲线图

请在此处插入你绘制的插值曲线对比图(原始数据点和两种插值曲线)。图表应包含以下元素：
![image](https://github.com/user-attachments/assets/56c8df9e-4998-4f9a-9f1a-55cf34c2d084)

- 原始数据点(带误差棒)
- 拉格朗日插值曲线
- 三次样条插值曲线
- 图表标题："Neutron Resonance Scattering Cross Section Analysis"
- X轴标签："Energy (MeV)"
- Y轴标签："Cross Section (mb)"
- 图例，包括数据点和两种插值曲线的说明

### 3.3 核心代码片段

请在此处粘贴你实现的代码：

```python
# 拉格朗日插值
n = len(x_data)
    result = 0.0
    
    for i in range(n):
        term = y_data[i]
        for j in range(n):
            if j != i:
                term *= (x - x_data[j]) / (x_data[i] - x_data[j])
        result += term
    return result

# 三次样条插值
def cubic_spline_interpolation(x, x_data, y_data):
    f = interp1d(x_data, y_data, kind='cubic', fill_value='extrapolate')
    return f(x)

# FWHM计算
def find_peak(x, y):
    peak_idx = np.argmax(y)
    half_max = y[peak_idx] / 2
    # 左半高插值
    left_idx = np.where(y[:peak_idx] <= half_max)[0]
    x_left = x[0] if len(left_idx) == 0 else np.interp(half_max, y[left_idx[-1]:peak_idx+1][::-1], x[left_idx[-1]:peak_idx+1][::-1])
    # 右半高插值
    right_idx = np.where(y[peak_idx:] <= half_max)[0]
    x_right = x[-1] if len(right_idx) == 0 else np.interp(half_max, y[peak_idx:peak_idx+right_idx[0]+1], x[peak_idx:peak_idx+right_idx[0]+1])
    return x[peak_idx], x_right - x_left
```
## 4. 分析与讨论
### 4.1 插值方法比较
请分析两种插值方法的结果差异，讨论：

1. 曲线平滑度比较
2. 边界行为差异
3. 计算效率比较
4. 哪种方法更适合本实验数据？为什么？

| 维度           | 拉格朗日多项式                           | 三次样条                         |
|----------------|------------------------------------------|----------------------------------|
| **平滑度**     | 高阶振荡显著（龙格现象）                 | 分段光滑，无振荡                 |
| **边界行为**   | 边界外推不稳定                           | 自然样条边界（二阶导数为零）     |
| **计算效率**   | O(n²)复杂度，计算速度慢                  | O(n)复杂度，快速计算             |
| **适用性**     | 适合低阶插值或密集数据                   | 适合稀疏数据和高平滑性要求       |

**结论**：三次样条更适合本实验数据，因其避免高阶振荡，且数据点稀疏（仅9个），需保证物理连续性。
### 4.2 共振峰分析
请讨论你得到的共振峰位置和FWHM结果：

1. 与原始数据峰值位置的比较
2. 两种插值方法结果的差异
3. 可能的误差来源
1. **与原始数据比较**：原始数据峰值在75 MeV（83.5 mb），三次样条结果（78.5 MeV）更接近，拉格朗日插值因振荡左移。  
2. **差异来源**：拉格朗日插值的过冲导致峰值偏移，三次样条局部拟合更准确。  
3. **误差因素**：原始数据在75 MeV处误差最大（85.5 mb），插值结果对噪声敏感。

### 4.3 思考题
1. 对于这种类型的实验数据，为什么三次样条插值通常比高阶多项式插值更合适？
 **三次样条的优势**：避免龙格现象，分段低阶多项式保证局部平滑性，适合物理量连续变化的实验数据
3. 如果数据点更密集或更稀疏，会对插值结果产生什么影响？
**数据密度影响**：  
   - **密集数据**：拉格朗日插值振荡减弱，三次样条更精确；  
   - **稀疏数据**：三次样条仍能保持平滑，拉格朗日插值误差显著增大。
## 5. 结论
请总结本次实验的主要发现和收获，特别是：

- 对两种插值方法特点的理解
- 中子共振散射数据分析的经验
- 插值方法选择对结果分析的影响
1. **插值方法特性**：  
   - 拉格朗日插值易受龙格现象影响，适合低阶或密集数据；  
   - 三次样条平滑性强，适合稀疏数据和物理量连续场景。  
2. **数据分析经验**：插值方法的选择直接影响共振峰参数的可靠性，需结合数据特征和物理背景。  
3. **实际应用**：在核物理实验中，三次样条插值是更优选择，因其能平衡平滑性与计算效率。
